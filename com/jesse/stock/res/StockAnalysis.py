#! /usr/bin env python3

from com.jesse.stock.res.Stock import Stock
from com.jesse.stock.res.CommonExecutor import CommonExecutor
import json
import datetime
import requests
import logging
import traceback
import time
import re


class StockAnalysis:
    def __init__(self, executor):
        self.executor = executor
        self.GOOD_STOCKS = "./basicInfo/good_stocks.json"
        self.stocks = [Stock("sz300280")]

    def fetchLocalData(self):
        self.stocks = []
        with open(self.GOOD_STOCKS, "r") as goodStocks:
            try:
                stocks = json.load(goodStocks)
                for stock in stocks:
                    self.stocks.append(Stock(stock))
                    pass
            except:
                print("get data error")

    def fetchBasicData(self):
        # url =
        # response = requests.get(url).text
        # response = '181009 22.05 21.82 22.12 21.26 628633'
        # pattern = re.compile(r'[0-9]{0,6}\s\d{0,2}\.\d{0,2}\s\d{0,2}\.\d{0,2}\s\d{0,2}\.\d{0,2}\s\d{0,2}\.\d{0,2}\s\d*')
        # pattern.findall(response)
        pattern = re.compile(r'[0-9]{0,6}\s\d{0,2}\.\d{0,2}\s\d{0,2}\.\d{0,2}\s\d{0,2}\.\d{0,2}\s\d{0,2}\.\d{0,2}\s\d*')
        for index, stock in enumerate(self.stocks):
            if index % 20 == 0:
                time.sleep(5)
                print("processing---sleeping for 5 second")
            print("processing---" + str(round((index + 1) / len(self.stocks) * 100, 2)) + "%")
            try:
                url = 'http://data.gtimg.cn/flashdata/hushen/daily/18/' + stock.stock_name + '.js?visitDstTime=1'
                response = requests.get(url).text
                url2 = 'http://data.gtimg.cn/flashdata/hushen/daily/19/' + stock.stock_name + '.js?visitDstTime=1'
                response2 = requests.get(url2).text
                response = response + "    " + response2
                data = pattern.findall(response)
                stock.setData(data)
                stock.fibonacci()
            except Exception as err:
                print(err)
    def fetchWeekInfo(self):
        for index, stock in enumerate(self.stocks):
            if index%30 == 0:
                time.sleep(5)
                print("processing===sleeping for 5 second")
            print("processing===" + str(round((index + 1) / len(self.stocks) * 100, 2)) + "%")
            try:
                url = "http://web.ifzq.gtimg.cn/appstock/app/fqkline/get?_var=kline_weekqfq&param="+stock.stock_name+",week,,,320,qfq"
                response = requests.get(url).text
                partten = re.compile(r'\S*=(.*)')
                data = partten.findall(response)
                jsonData = json.loads(data[0])
                stock.weekData = jsonData["data"][stock.stock_name]["qfqweek"]
                stock.fibonacciWeekData()
                print(stock.weekData)
                #print(stock.weekData)
            except Exception as err:
                print(traceback.format_exc())

    def test(self):
        strings = 'kline_weekqfq={"code":0,"msg":"","data":{"sh600004":{"qfqweek":[["2012-12-21","3.954","4.069","4.104","3.925","291837.000"],["2012-12-28","4.069","4.064","4.116","4.006","198734.000"],["2013-01-04","4.069","4.087","4.133","4.069","83002.000"],["2013-01-11","4.087","4.012","4.133","4.006","165189.000"],["2013-01-18","3.994","4.208","4.225","3.994","328527.000"],["2013-01-25","4.214","4.173","4.370","4.139","270386.000"],["2013-02-01","4.173","4.375","4.433","4.162","254889.000"],["2013-02-08","4.393","4.462","4.525","4.341","276205.000"],["2013-02-22","4.468","4.266","4.491","4.254","185376.000"],["2013-03-01","4.277","4.295","4.318","4.202","103681.000"],["2013-03-08","4.271","4.277","4.318","4.179","120242.000"],["2013-03-15","4.271","4.081","4.318","4.029","156944.000"],["2013-03-22","4.075","4.110","4.162","4.058","136775.000"],["2013-03-29","4.116","3.989","4.133","3.977","100255.000"],["2013-04-03","4.000","3.983","4.029","3.954","42865.000"],["2013-04-12","3.925","3.896","3.954","3.862","116018.000"],["2013-04-19","3.896","3.983","3.989","3.873","117233.000"],["2013-04-26","3.966","3.960","4.029","3.925","152244.000"],["2013-05-03","3.954","4.017","4.035","3.942","66863.000"],["2013-05-10","4.012","3.942","4.052","3.908","256716.000"],["2013-05-17","3.948","4.000","4.012","3.879","258129.000"],["2013-05-24","4.017","4.012","4.058","3.977","208965.000"],["2013-05-31","4.012","4.069","4.121","3.983","240994.000"],["2013-06-07","4.081","3.977","4.156","3.925","183735.000"],["2013-06-14","3.960","3.890","3.960","3.862","62699.000"],["2013-06-21","3.896","3.781","3.908","3.712","99468.000"],["2013-06-28","3.775","3.631","3.775","3.458","182975.000"],["2013-07-05","3.619","3.642","3.683","3.590","97171.000"],["2013-07-12","3.625","3.706","3.763","3.538","115775.000"],["2013-07-19","3.712","3.648","3.763","3.642","95839.000"],["2013-07-26","3.648","3.680","3.752","3.642","212634.000",{"nd":"2012","fh_sh":"3.135","djr":"2013-07-25","cqr":"2013-07-26","FHcontent":"10\u6d3e3.3\u5143"}],["2013-08-02","3.680","3.711","3.747","3.619","142400.000"],["2013-08-09","3.723","3.741","3.765","3.699","138114.000"],["2013-08-16","3.741","3.741","3.863","3.723","215572.000"],["2013-08-23","3.723","3.747","3.778","3.717","113455.000"],["2013-08-30","3.747","4.118","4.185","3.735","547542.000"],["2013-09-06","4.118","4.100","4.282","3.924","570572.000"],["2013-09-13","4.094","4.362","4.666","4.063","1004858.000"],["2013-09-18","4.362","4.222","4.447","4.161","221511.000"],["2013-09-27","4.222","4.100","4.331","4.063","279214.000"],["2013-09-30","4.106","4.118","4.136","4.094","26927.000"],["2013-10-11","4.124","4.252","4.282","4.100","222083.000"],["2013-10-18","4.258","4.179","4.374","4.149","249029.000"],["2013-10-25","4.191","4.045","4.234","4.027","187521.000"],["2013-11-01","4.039","4.222","4.349","3.948","283435.000"],["2013-11-08","4.228","4.082","4.252","4.051","139797.000"],["2013-11-15","4.082","4.143","4.179","4.033","142341.000"],["2013-11-22","4.191","4.313","4.435","4.167","372387.000"],["2013-11-29","4.319","4.337","4.435","4.282","287274.000"],["2013-12-06","4.295","4.343","4.416","4.143","301528.000"],["2013-12-13","4.355","4.441","4.489","4.325","341654.000"],["2013-12-20","4.441","4.209","4.447","4.185","239788.000"],["2013-12-27","4.197","4.276","4.459","4.130","372482.000"],["2014-01-03","4.282","4.185","4.313","4.118","165586.000"],["2014-01-10","4.161","3.997","4.161","3.954","155636.000"],["2014-01-17","4.003","4.015","4.057","3.924","108081.000"],["2014-01-24","3.997","4.124","4.155","3.954","100582.000"],["2014-01-30","4.112","4.088","4.130","4.045","73415.000"],["2014-02-07","4.082","4.070","4.082","4.033","20703.000"],["2014-02-14","4.076","4.343","4.550","4.070","506107.000"],["2014-02-21","4.349","4.246","4.428","4.216","406036.000"],["2014-02-28","4.252","4.301","4.441","4.167","482379.000"],["2014-03-07","4.289","4.258","4.362","4.216","254958.000"],["2014-03-14","4.228","4.076","4.252","4.027","192990.000"],["2014-03-21","4.076","4.161","4.167","4.051","151881.000"],["2014-03-28","4.149","4.264","4.307","4.143","218071.000"],["2014-04-04","4.264","4.246","4.295","4.203","152476.000"],["2014-04-11","4.240","4.313","4.343","4.228","184688.000"],["2014-04-18","4.307","4.289","4.325","4.228","159291.000"],["2014-04-25","4.258","4.191","4.301","4.136","200997.000"],["2014-04-30","4.185","4.197","4.209","4.100","92926.000"],["2014-05-09","4.185","4.167","4.276","4.149","168514.000"],["2014-05-16","4.191","4.246","4.295","4.155","177833.000"],["2014-05-23","4.234","4.289","4.289","4.179","135325.000"],["2014-05-30","4.289","4.246","4.307","4.209","136487.000"],["2014-06-06","4.246","4.197","4.258","4.167","85582.000"],["2014-06-13","4.179","4.246","4.246","4.167","95401.000"],["2014-06-20","4.240","4.173","4.246","4.143","137823.000"],["2014-06-27","4.179","4.264","4.307","4.167","158313.000"],["2014-07-04","4.264","4.325","4.343","4.246","170621.000"],["2014-07-11","4.325","4.325","4.331","4.258","147675.000"],["2014-07-18","4.343","4.441","4.459","4.319","283210.000"],["2014-07-25","4.422","4.471","4.489","4.349","207076.000"],["2014-08-01","4.483","4.483","4.544","4.453","320679.000"],["2014-08-08","4.526","4.520","4.605","4.494","397321.000",{"nd":"2013","fh_sh":"3.515","djr":"2014-08-07","cqr":"2014-08-08","FHcontent":"10\u6d3e3.7\u5143"}],["2014-08-15","4.507","4.558","4.590","4.507","258045.000"],["2014-08-22","4.565","4.801","4.859","4.552","470209.000"],["2014-08-29","4.795","4.763","4.885","4.673","362473.000"],["2014-09-05","4.744","5.013","5.045","4.731","491842.000"],["2014-09-12","5.006","5.205","5.211","5.000","535832.000"],["2014-09-19","5.160","5.147","5.352","5.057","425680.000"],["2014-09-26","5.128","5.173","5.269","5.064","301711.000"],["2014-09-30","5.192","5.346","5.352","5.160","205721.000"],["2014-10-10","5.346","5.256","5.390","5.250","207341.000"],["2014-10-17","5.230","5.326","5.506","5.153","511737.000"],["2014-10-24","5.320","5.282","5.538","5.218","357965.000"],["2014-10-31","5.269","5.871","6.011","5.173","679320.000"],["2014-11-07","5.922","5.922","6.191","5.845","677011.000"],["2014-11-14","5.960","6.197","6.440","5.960","795803.000"],["2014-11-21","6.325","6.223","6.389","5.922","545475.000"],["2014-11-28","6.242","6.453","6.671","6.146","770650.000"],["2014-12-05","6.459","6.402","6.658","6.216","943885.000"],["2014-12-12","6.517","7.900","8.540","6.408","2314556.000"],["2014-12-19","8.322","7.817","8.322","7.490","1475642.000"],["2014-12-26","7.682","7.573","7.778","7.125","858675.000"],["2014-12-31","7.452","6.997","7.465","6.818","823792.000"],["2015-01-09","7.042","7.279","7.593","7.004","1033429.000"],["2015-01-16","7.228","7.266","7.343","6.927","452429.000"],["2015-01-23","6.863","7.324","7.509","6.594","667285.000"],["2015-01-30","7.292","7.119","7.490","7.112","442065.000"],["2015-02-06","7.061","6.735","7.093","6.677","341735.000"],["2015-02-13","6.728","6.869","6.933","6.555","336317.000"],["2015-02-17","6.876","7.138","7.138","6.863","142631.000"],["2015-02-27","7.061","7.311","7.394","6.972","293872.000"],["2015-03-06","7.394","7.048","7.413","6.997","383630.000"],["2015-03-13","7.016","7.330","7.458","6.946","534886.000"],["2015-03-20","7.426","7.874","8.118","7.375","1135212.000"],["2015-03-27","7.881","8.073","8.284","7.650","1144589.920"],["2015-04-03","8.156","8.546","8.591","8.156","1199906.000"],["2015-04-10","8.566","8.540","8.879","8.233","860589.000"],["2015-04-17","8.534","9.257","9.423","8.534","1132214.000"],["2015-04-24","9.289","9.391","9.968","9.091","1172547.000"],["2015-04-30","9.411","9.552","9.859","9.129","747689.000"],["2015-05-08","9.724","9.801","10.281","9.110","1121533.000"],["2015-05-15","9.859","9.731","10.038","9.603","721920.000"],["2015-05-22","9.673","10.653","10.691","9.411","938439.000"],["2015-05-29","10.582","11.101","12.279","10.505","1332038.000"],["2015-06-05","11.139","12.420","12.996","11.088","1312108.000"],["2015-06-12","12.413","12.862","13.207","12.195","1205967.000",{"nd":"2014","fh_sh":"2.755","djr":"2015-06-11","cqr":"2015-06-12","FHcontent":"10\u6d3e2.9\u5143"}],["2015-06-19","12.927","11.543","14.077","11.543","1355399.000"],["2015-06-26","11.491","9.945","12.161","9.939","889974.000"],["2015-07-03","10.257","8.458","11.108","8.153","1622478.000"],["2015-07-10","9.302","8.854","9.302","7.185","2058419.000"],["2015-07-17","9.341","9.510","10.290","8.484","1031127.000"],["2015-07-24","9.484","9.653","10.095","9.172","913597.000"],["2015-07-31","9.419","8.958","9.614","8.127","783889.000"],["2015-08-07","8.783","9.556","9.718","8.718","565379.000"],["2015-08-14","9.666","9.984","10.238","9.569","594746.000"],["2015-08-21","9.939","9.205","10.705","9.094","683468.000"],["2015-08-28","8.867","8.594","8.997","7.243","669915.000"],["2015-09-02","8.445","8.107","8.445","7.477","340382.000"],["2015-09-11","8.120","8.127","8.503","7.808","454088.000"],["2015-09-18","8.153","7.743","8.191","7.470","377073.000"],["2015-09-25","7.685","7.795","8.120","7.600","280390.000"],["2015-09-30","7.841","7.789","7.899","7.704","88797.000"],["2015-10-09","8.023","8.172","8.198","8.003","147897.000"],["2015-10-16","8.204","8.919","8.971","8.127","412008.000"],["2015-10-23","8.835","8.724","8.939","8.250","352572.000"],["2015-10-30","8.867","8.744","8.874","8.393","310931.000"],["2015-11-06","8.614","9.328","9.718","8.614","922558.000"],["2015-11-13","9.387","9.003","9.497","8.945","667954.000"],["2015-11-20","8.965","9.049","9.257","8.874","396204.000"],["2015-11-27","9.036","8.581","9.101","8.542","510243.000"],["2015-12-04","8.640","8.900","9.114","8.386","397208.000"],["2015-12-11","8.939","8.971","9.146","8.835","300082.000"],["2015-12-18","8.900","9.328","9.458","8.848","471141.000"],["2015-12-25","9.257","9.374","9.874","9.224","677358.000"],["2015-12-31","9.478","9.244","9.478","9.049","418995.000"],["2016-01-08","9.276","8.250","9.276","7.893","602351.000"],["2016-01-15","8.107","7.581","8.191","7.522","401222.000"],["2016-01-22","7.470","8.029","8.224","7.405","355289.000"],["2016-01-29","8.049","7.932","8.166","7.392","307063.000"],["2016-02-05","7.925","8.023","8.198","7.717","213861.000"],["2016-02-19","7.847","8.263","8.367","7.847","236858.000"],["2016-02-26","8.295","7.711","8.822","7.633","1110779.000"],["2016-03-04","7.626","7.620","7.769","7.243","582107.000"],["2016-03-11","7.672","7.535","7.815","7.444","252373.000"],["2016-03-18","7.594","8.016","8.068","7.594","352814.000"],["2016-03-25","8.049","7.925","8.179","7.815","298445.000"],["2016-04-01","7.971","8.003","8.146","7.795","402863.000"],["2016-04-08","7.990","8.029","8.308","7.958","217640.000"],["2016-04-15","8.075","8.282","8.354","8.062","233694.000"],["2016-04-22","8.250","7.873","8.250","7.763","260621.000"],["2016-04-29","7.854","7.808","7.951","7.743","198818.000"],["2016-05-06","7.828","7.971","8.159","7.821","405131.000"],["2016-05-13","7.958","7.919","8.217","7.665","359677.000"],["2016-05-20","7.919","7.815","8.036","7.750","200518.000"],["2016-05-27","7.789","7.769","7.971","7.730","180325.000"],["2016-06-03","7.763","7.977","8.003","7.711","306249.000"],["2016-06-08","7.997","7.899","8.094","7.854","128659.000"],["2016-06-17","7.847","7.854","7.899","7.730","176836.000"],["2016-06-24","7.841","7.828","7.964","7.685","172335.000"],["2016-07-01","7.828","7.977","8.003","7.815","163171.000"],["2016-07-08","7.971","8.120","8.250","7.938","304226.000"],["2016-07-15","8.140","8.484","8.523","8.081","494336.000"],["2016-07-22","8.484","8.575","8.711","8.347","386644.000"],["2016-07-29","8.542","8.822","9.029","8.529","483286.000"],["2016-08-05","8.783","8.776","8.822","8.601","254857.000",{"nd":"2015","fh_sh":"3.2","djr":"2016-08-04","cqr":"2016-08-05","FHcontent":"10\u6d3e3.2\u5143"}],["2016-08-12","8.710","8.856","8.856","8.557","300645.000"],["2016-08-19","8.823","9.016","9.189","8.823","508661.000"],["2016-08-26","9.022","9.435","9.601","9.002","448162.000"],["2016-09-02","9.395","9.195","9.415","9.129","297374.000"],["2016-09-09","9.202","9.555","9.641","9.189","303382.000"],["2016-09-14","9.435","9.189","9.448","9.149","189450.000"],["2016-09-23","9.195","9.375","9.555","9.189","220644.000"],["2016-09-30","9.375","9.195","9.388","9.089","156695.000"],["2016-10-14","9.249","9.315","9.415","9.195","204549.000"],["2016-10-21","9.309","9.468","9.482","9.242","208185.000"],["2016-10-28","9.482","9.648","9.741","9.455","216144.000"],["2016-11-04","9.668","9.768","9.894","9.615","234992.000"],["2016-11-11","9.741","10.154","10.193","9.701","243674.000"],["2016-11-18","10.147","9.981","10.187","9.961","197704.000"],["2016-11-25","9.974","9.981","10.067","9.881","200245.000"],["2016-12-02","10.001","9.761","10.213","9.708","450925.000"],["2016-12-09","9.714","9.768","9.808","9.688","197673.000"],["2016-12-16","9.774","9.342","9.808","9.102","402802.000"],["2016-12-23","9.289","9.408","9.548","9.262","202721.000"],["2016-12-30","9.382","9.375","9.535","9.269","165325.000"],["2017-01-06","9.375","9.548","9.661","9.375","191299.000"],["2017-01-13","9.535","9.402","9.675","9.362","174759.000"],["2017-01-20","9.382","9.428","9.435","9.102","302654.000"],["2017-01-26","9.422","9.608","9.661","9.415","148444.000"],["2017-02-03","9.568","9.482","9.608","9.428","57032.000"],["2017-02-10","9.482","9.688","9.714","9.428","204979.000"],["2017-02-17","9.694","9.535","9.754","9.528","236456.000"],["2017-02-24","9.555","10.213","10.440","9.541","491741.000"],["2017-03-03","10.120","9.941","10.147","9.794","257091.000"],["2017-03-10","9.914","10.107","10.154","9.914","290643.000"],["2017-03-17","10.386","10.752","10.885","10.280","685003.000"],["2017-03-24","10.752","10.919","10.945","10.460","467424.000"],["2017-03-31","10.925","10.606","11.118","10.440","521767.000"],["2017-04-07","10.646","10.759","10.812","10.586","280527.000"],["2017-04-14","10.719","10.819","11.278","10.347","1321949.000"],["2017-04-21","10.746","10.826","10.959","10.406","548003.000"],["2017-04-28","10.832","10.613","10.839","10.460","380459.000"],["2017-05-05","10.659","11.105","11.325","10.659","777082.000"],["2017-05-12","11.145","10.945","11.238","10.520","589484.000"],["2017-05-19","11.045","11.271","11.431","10.959","953749.000"],["2017-05-26","11.258","10.852","11.345","10.573","1328372.000"],["2017-06-02","10.879","11.192","11.345","10.852","821118.000"],["2017-06-09","11.198","12.057","12.223","11.112","1118885.000"],["2017-06-16","12.037","11.804","12.556","11.724","801516.000"],["2017-06-23","11.784","12.283","12.303","11.671","931248.000"],["2017-06-30","12.329","12.283","12.496","11.990","885329.000"],["2017-07-07","12.309","13.234","13.341","12.309","1050196.000"],["2017-07-14","13.241","13.482","13.551","12.842","650083.000",{"nd":"2016","fh_sh":"3.7","djr":"2017-07-13","cqr":"2017-07-14","FHcontent":"10\u6d3e3.7\u5143\u90014.5\u80a1"}],["2017-07-21","13.374","13.817","14.210","12.647","1153668.000"],["2017-07-28","13.758","13.276","13.945","13.040","774261.000"],["2017-08-04","13.237","13.197","13.423","13.079","737878.000"],["2017-08-11","13.197","12.656","13.246","12.597","872856.000"],["2017-08-18","12.627","13.060","13.138","12.558","555420.000"],["2017-08-25","13.060","12.951","13.148","12.814","328459.000"],["2017-09-01","12.981","13.158","13.610","12.932","787577.000"],["2017-09-08","13.119","13.443","13.551","12.883","795993.000"],["2017-09-15","13.453","13.079","13.571","13.030","677965.000"],["2017-09-22","13.079","12.794","13.217","12.627","631169.000"],["2017-09-29","12.784","12.873","12.971","12.529","545850.000"],["2017-10-13","13.030","12.755","13.119","12.342","1318373.000"],["2017-10-20","12.755","12.873","13.099","12.538","701257.000"],["2017-10-27","12.863","13.522","13.591","12.686","1037591.000"],["2017-11-03","13.620","13.709","14.082","13.374","1316005.000"],["2017-11-10","13.748","14.977","15.095","13.718","1209687.000"],["2017-11-17","15.125","14.761","15.380","14.358","1125532.000"],["2017-11-24","14.751","14.141","15.587","13.954","1260964.000"],["2017-12-01","14.151","13.817","14.230","13.650","590571.000"],["2017-12-08","13.787","13.640","14.161","13.433","669323.000"],["2017-12-15","13.699","14.368","14.535","13.650","689940.000"],["2017-12-22","14.377","14.436","14.722","14.092","586616.000"],["2017-12-29","14.407","14.456","14.633","13.895","619498.000"],["2018-01-05","14.486","14.328","14.604","14.240","587178.000"],["2018-01-12","14.436","14.702","14.781","14.132","837359.000"],["2018-01-19","14.653","15.498","15.813","14.584","1128753.000"],["2018-01-26","15.508","16.256","16.521","15.262","814880.000"],["2018-02-02","16.246","16.934","17.013","15.823","902684.000"],["2018-02-09","16.502","14.653","17.121","13.768","1299330.000"],["2018-02-14","14.653","15.666","15.823","14.584","358185.000"],["2018-02-23","15.882","16.216","16.393","15.774","196306.000"],["2018-03-02","16.206","15.921","16.885","15.784","453095.000"],["2018-03-09","15.852","16.029","16.157","15.469","362869.000"],["2018-03-16","16.020","15.666","16.305","15.587","346504.000"],["2018-03-23","15.636","14.977","15.725","14.633","373912.000"],["2018-03-30","14.928","15.380","15.508","14.574","501249.000"],["2018-04-04","15.351","15.203","15.420","14.771","227043.000"],["2018-04-13","15.174","15.616","16.128","15.056","453954.000"],["2018-04-20","15.577","14.977","15.833","14.653","431710.000"],["2018-04-27","14.997","14.967","15.095","14.495","424340.000"],["2018-05-04","14.977","14.849","15.174","14.790","217142.000"],["2018-05-11","14.967","15.970","16.108","14.810","541289.000"],["2018-05-18","15.951","15.734","16.108","15.479","496069.000"],["2018-05-25","15.921","15.144","16.079","14.997","453616.000"],["2018-06-01","15.194","16.285","16.442","15.095","863954.000"],["2018-06-08","16.354","17.623","17.947","16.344","988457.000"],["2018-06-15","17.465","18.173","18.557","17.259","756159.000"],["2018-06-22","16.354","13.984","16.354","13.797","1802131.000"],["2018-06-29","14.033","12.873","14.181","12.194","1497686.000"],["2018-07-06","12.833","13.050","13.227","12.519","900908.000"],["2018-07-13","13.079","14.290","14.580","12.991","729350.000",{"nd":"2017","fh_sh":"2.4","djr":"2018-07-12","cqr":"2018-07-13","FHcontent":"10\u6d3e2.4\u5143"}],["2018-07-20","14.330","14.290","14.650","13.950","518616.000"],["2018-07-27","14.200","14.120","14.840","13.990","477585.000"],["2018-08-03","14.120","13.240","14.460","13.040","477257.000"],["2018-08-10","13.190","13.740","13.870","12.900","470970.000"],["2018-08-17","13.670","12.640","13.730","12.580","365365.000"],["2018-08-24","12.330","12.330","12.970","11.850","653571.000"],["2018-08-31","12.490","12.210","12.950","12.010","475865.000"],["2018-09-07","12.110","11.760","12.170","11.520","351280.000"],["2018-09-14","11.680","11.870","11.970","11.510","267683.000"],["2018-09-21","11.870","12.570","12.640","11.700","325383.000"],["2018-09-28","12.420","12.770","12.770","12.250","374357.000"],["2018-10-12","12.330","11.380","12.540","10.950","473530.000"],["2018-10-19","11.400","11.090","11.530","10.660","361546.000"],["2018-10-26","11.090","10.830","11.930","10.760","403077.000"],["2018-11-02","10.830","10.600","10.840","9.500","1280384.000"],["2018-11-09","10.400","9.870","10.520","9.850","641647.000"],["2018-11-16","9.880","10.350","10.500","9.790","585849.000"],["2018-11-23","10.300","9.760","10.450","9.760","403334.000"],["2018-11-30","9.780","10.130","10.180","9.750","309587.000"],["2018-12-07","10.280","10.330","10.740","10.200","520950.000"],["2018-12-14","10.240","10.600","11.100","10.180","723363.000"],["2018-12-21","10.650","10.230","10.830","10.140","487894.000"],["2018-12-28","10.170","10.050","10.370","9.790","392836.000"],["2019-01-04","10.050","9.900","10.120","9.640","239842.000"],["2019-01-11","9.990","9.770","10.020","9.650","580388.000"],["2019-01-18","9.770","10.360","10.590","9.530","1181378.000"],["2019-01-25","10.360","10.830","11.280","10.360","1664459.000"],["2019-02-01","10.870","11.600","11.940","10.800","1400250.000"],["2019-02-15","11.490","12.170","12.660","11.460","848716.000"],["2019-02-22","12.230","12.330","13.450","12.030","1163357.000"],["2019-03-01","12.420","13.150","13.170","12.180","1087469.000"],["2019-03-08","13.150","13.010","14.060","12.690","1169399.000"],["2019-03-14","13.050","13.17","13.700","13.00","744402"]],"qt":{"sh600004":["1","\u767d\u4e91\u673a\u573a","600004","13.17","13.30","13.40","128324","61747","66540","13.17","567","13.16","576","13.15","114","13.14","61","13.12","141","13.18","53","13.19","82","13.20","72","13.21","134","13.22","40","15:00:13\/13.17\/464\/S\/611088\/48413|14:56:59\/13.17\/4\/S\/5268\/47578|14:56:56\/13.17\/17\/S\/22389\/47564|14:56:54\/13.17\/69\/B\/90900\/47555|14:56:51\/13.17\/93\/B\/122444\/47543|14:56:42\/13.17\/3\/B\/3949\/47501","20190314153003","-0.13","-0.98","13.58","13.00","13.17\/128324\/170873614","128324","17087","0.62","20.37","","13.58","13.00","4.36","272.53","272.53","1.73","14.63","11.97","0.63","1078","13.32","22.25","17.08"],"market":["2019-03-14 16:04:01|HK_open_\u6536\u5e02\u7ade\u4ef7\u4e2d|SH_close_\u5df2\u6536\u76d8|SZ_close_\u5df2\u6536\u76d8|US_close_\u672a\u5f00\u76d8|SQ_close_\u5df2\u4f11\u5e02|DS_close_\u5df2\u4f11\u5e02|ZS_close_\u5df2\u4f11\u5e02|NEWSH_close_\u5df2\u6536\u76d8|NEWSZ_close_\u5df2\u6536\u76d8|NEWHK_open_\u6536\u76d8\u7ade\u4ef7|NEWUS_close_\u672a\u5f00\u76d8|REPO_close_\u5df2\u6536\u76d8"],"zjlx":["sh600004","613.11","796.02","-182.91","-2.25","7503.01","7817.14","-314.13","-3.65","170873614.00","9252.52","6655.71","\u767d\u4e91\u673a\u573a","20190314","20190313^2876.39^978.73","20190312^1350.52^2139.10","20190311^1660.81^1092.85","20190308^2751.68^1649.01","1049561.00","11513270.00","20190314150006"]},"mx_price":{"mx":{"data":[],"timeline":[]},"price":{"data":[]}},"prec":"3.954","version":"12"}}}'
        partten = re.compile(r'\S*=(.*)')
        data = partten.findall(strings)
        print(data[0])

def main():
    stockAnalysis = StockAnalysis(CommonExecutor())
    # stockAnalysis.fetchLocalData()
    stockAnalysis.fetchWeekInfo()
    # for stock in stockAnalysis.stocks:
    #     print("for stock=" + stock.stock_name)
    #     if stock.isThisStockGrowth():
    #         if stock.goodGrowth():
    #             print(stock.stock_name + "{增长中反弹确立*****}")
    #         if stock.power():
    #             print(stock.stock_name + "{增长中蓄势待发, 参考周线判定是否到位***}")
    #         if stock.distroy():
    #             print(stock.stock_name + "{增长中极限回调****}")
    #     else:
    #         if stock.goodGrowth():
    #             print(stock.stock_name + "{弱势中反弹确立，参考周线判定是否到位****}")


main()
